{"version":3,"sources":["../../src/hooks/useRequest.js"],"names":["useRequest","fn","deps","initialState","status","loading","lastCallId","state","isMounted","callback","callId","current","then","value","error"],"mappings":";;;;;;;AAAA;;AACA;;;;AAEe,SAASA,UAAT,CAAoBC,EAApB,EAGZ;AAAA,MAHoCC,IAGpC,uEAH2C,EAG3C;AAAA,MAH+CC,YAG/C,uEAH8D;AAC/DC,IAAAA,MAAM,EAAE,SADuD;AAE/DC,IAAAA,OAAO,EAAE;AAFsD,GAG9D;AACD,MAAMC,UAAU,GAAG,mBAAO,CAAP,CAAnB;AACA,MAAMC,KAAK,GAAG,mBAAOJ,YAAP,CAAd;AACA,MAAMK,SAAS,GAAG,kCAAlB;AAEA,MAAMC,QAAQ,GAAG,wBAAY,YAAM;AACjC,QAAMC,MAAM,GAAG,EAAEJ,UAAU,CAACK,OAA5B;AAEAJ,IAAAA,KAAK,CAACI,OAAN,GAAgB;AACdP,MAAAA,MAAM,EAAE,SADM;AAEdC,MAAAA,OAAO,EAAE;AAFK,KAAhB;AAKA,WAAOJ,EAAE,GAAGW,IAAL,CACL,UAAAC,KAAK,EAAI;AACP,UAAIL,SAAS,MAAME,MAAM,KAAKJ,UAAU,CAACK,OAAzC,EAAkD;AAChDJ,QAAAA,KAAK,CAACI,OAAN,GAAgBE,KAAhB;AACD;;AACD,aAAOA,KAAP;AACD,KANI,EAOL,UAAAC,KAAK,EAAI;AACP,UAAIN,SAAS,MAAME,MAAM,KAAKJ,UAAU,CAACK,OAAzC,EAAkD;AAChDJ,QAAAA,KAAK,CAACI,OAAN,GAAgBG,KAAhB;AACD;;AACD,aAAOA,KAAP;AACD,KAZI,CAAP;AAcD,GAtBgB,EAsBdZ,IAtBc,CAAjB;AAwBA,SAAO,CAACK,KAAK,CAACI,OAAP,EAAgBF,QAAhB,CAAP;AACD","sourcesContent":["import { useCallback, useRef } from 'react';\nimport useMountedState from './useMountedState';\n\nexport default function useRequest(fn, deps = [], initialState = {\n  status: 'pending',\n  loading: false\n}) {\n  const lastCallId = useRef(0);\n  const state = useRef(initialState);\n  const isMounted = useMountedState();\n\n  const callback = useCallback(() => {\n    const callId = ++lastCallId.current;\n\n    state.current = {\n      status: 'loading',\n      loading: true\n    };\n\n    return fn().then(\n      value => {\n        if (isMounted() && callId === lastCallId.current) {\n          state.current = value;\n        }\n        return value;\n      },\n      error => {\n        if (isMounted() && callId === lastCallId.current) {\n          state.current = error;\n        }\n        return error;\n      }\n    );\n  }, deps);\n\n  return [state.current, callback];\n}\n"],"file":"useRequest.js"}